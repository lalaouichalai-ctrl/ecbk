<!DOCTYPE html>
<html lang="fr">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Connexion Espace Client</title>
Â  Â  <link rel="stylesheet" href="styles.css">
Â  Â  <style>
Â  Â  Â  Â  /* Styles gÃ©nÃ©raux pour centrer la page et la carte de connexion */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  display: flex; justify-content: center; align-items: center;
Â  Â  Â  Â  Â  Â  min-height: 100vh; margin: 0;
Â  Â  Â  Â  Â  Â  /* Remplacez l'URL de l'image de fond par une version fonctionnelle ou locale */
Â  Â  Â  Â  Â  Â  background-image: url('https://upload.wikimedia.org/wikipedia/commons/e/e0/Bank_of_France_in_Lyon.jpg'); 
Â  Â  Â  Â  Â  Â  background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed;
Â  Â  Â  Â  Â  Â  background-color: #e6ecf2;
Â  Â  Â  Â  }
Â  Â  Â  Â  .login-container {
Â  Â  Â  Â  Â  Â  background: white; padding: 30px; border-radius: 8px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 12px rgba(0, 51, 102, 0.5); width: 350px; text-align: center;
Â  Â  Â  Â  Â  Â  z-index: 10; /* Assure que le formulaire est au-dessus de l'image de fond */
Â  Â  Â  Â  }
Â  Â  Â  Â  .login-container h2 { color: #003366; margin-bottom: 20px; border-bottom: none; }
Â  Â  Â  Â  .login-form input {
Â  Â  Â  Â  Â  Â  width: 100%; padding: 10px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;
Â  Â  Â  Â  }
Â  Â  Â  Â  .login-form button {
Â  Â  Â  Â  Â  Â  background-color: #0066cc; color: white; padding: 10px; border: none; border-radius: 4px; width: 100%;
Â  Â  Â  Â  Â  Â  cursor: pointer; font-size: 1.1em; font-weight: bold; transition: background-color 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .login-form button:hover { background-color: #0056b3; }
Â  Â  Â  Â  #errorMessage { color: #e74c3c; margin-top: 10px; font-weight: bold; }
Â  Â  </style>
</head>
<body>
Â  Â  <div class="login-container">
Â  Â  Â  Â  <center>
Â  Â  Â  Â  Â  Â  <img src="https://cdn1.vc4a.com/media/2017/03/19122931/Ecobank_Logo_400x400.jpg" height="180" width="190" alt="Logo Ecobank">
Â  Â  Â  Â  </center>
Â  Â  Â  Â  <h2>AccÃ©der Ã  mes comptes</h2>
Â  Â  Â  Â  <form id="login-form" class="login-form">
Â  Â  Â  Â  Â  Â  <input type="text" id="clientCode" placeholder="Code Client (10 chiffres)" maxlength="10" required>
Â  Â  Â  Â  Â  Â  <input type="password" id="pin" placeholder="PIN (6 chiffres)" maxlength="6" required>
Â  Â  Â  Â  Â  Â  <button type="submit">Se connecter</button>
Â  Â  Â  Â  Â  Â  <p id="errorMessage" style="display:none;"></p>
Â  Â  Â  Â  </form>
Â  Â  </div>

Â  Â  Â  Â  <script src="shared.js"></script> 
Â  Â  
Â  Â  <script>
Â  Â  Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  Â  Â  const loginForm = document.getElementById('login-form');
Â  Â  Â  Â  Â  Â  const clientCodeInput = document.getElementById('clientCode');
Â  Â  Â  Â  Â  Â  const pinInput = document.getElementById('pin');
Â  Â  Â  Â  Â  Â  const errorMessageDiv = document.getElementById('errorMessage'); // CORRIGÃ‰ : Utilise l'ID 'errorMessage'

            // Fonction pour afficher les messages d'erreur
            function displayError(message) {
                errorMessageDiv.textContent = message;
                errorMessageDiv.style.display = 'block';
            }

Â  Â  Â  Â  Â  Â  // La vÃ©rification d'utilisateur dÃ©jÃ  connectÃ© est dÃ©placÃ©e vers checkAuth dans shared.js

Â  Â  Â  Â  Â  Â  loginForm.addEventListener('submit', async (e) => { // Rendre la fonction asynchrone pour apiLogin
Â  Â  Â  Â  Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  Â  Â  Â  Â  errorMessageDiv.style.display = 'none';

Â  Â  Â  Â  Â  Â  Â  Â  const clientCode = clientCodeInput.value.trim();
Â  Â  Â  Â  Â  Â  Â  Â  const pin = pinInput.value.trim();

Â  Â  Â  Â  Â  Â  Â  Â  // VÃ©rification des formats (10 et 6 chiffres)
Â  Â  Â  Â  Â  Â  Â  Â  if (clientCode.length !== 10 || pin.length !== 6 || isNaN(clientCode) || isNaN(pin)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  displayError('Veuillez entrer un Code Client (10 chiffres) et un PIN (6 chiffres) valides.');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // ðŸš¨ NOUVEL APPEL ASYNCHRONE Ã€ LA FONCTION API
Â  Â  Â  Â  Â  Â  Â  Â  const result = await apiLogin(clientCode, pin);

Â  Â  Â  Â  Â  Â  Â  Â  if (result && result.clientCode) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Connexion rÃ©ussie, redirection
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (result.isAdmin) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.location.href = 'manage.html';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  window.location.href = 'dashboard.html';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Ã‰chec de la connexion
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  displayError(result.message || "Erreur inconnue lors de la connexion.");
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  });
Â  Â  </script>
</body>
</html>