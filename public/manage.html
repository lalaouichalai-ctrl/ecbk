<!DOCTYPE html>
<html lang="fr">
<head>
Â  <meta charset="UTF-8">
Â  <title>Admin - Gestion des Utilisateurs</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <link rel="stylesheet" href="styles.css">
Â  <style>
Â  Â  main { margin-right: 20px; }
Â  Â  .main-nav { background-color: #003366 !important; }
Â  Â  #user-summary-dashboard table { margin-top: 15px; width: 100%; border-collapse: collapse; }
Â  Â  #user-summary-dashboard th, #user-summary-dashboard td { padding: 10px; border-bottom: 1px solid #eee; text-align: left; }
Â  Â  #user-summary-dashboard th { background-color: #f9f9f9; }
Â  Â  .btn-select-user { padding: 6px 10px; font-size: 0.9em; cursor: pointer; }
Â  Â  .small-tabs .subtab { margin-right: 8px; }
Â  Â  .panel { margin-top: 15px; }
Â  Â  .account-block { padding: 15px; background: #fff; border: 1px solid #e5e5e5; border-radius: 8px; }
Â  Â  form label { display:block; margin-top:8px; font-weight:600; }
Â  Â  form input, form select, form textarea { width:100%; padding:8px; margin-top:6px; }
Â  Â  form button { margin-top:12px; padding:10px; }
Â  </style>
</head>
<body class="app-bg">

<header>
Â  <div class="top-bar">
Â  Â  <div class="user-info">
Â  Â  Â  <span>Bienvenue Admin</span>
Â  Â  Â  <span class="last-conn">DerniÃ¨re connexion...</span>
Â  Â  Â  <span class="status" id="logoutLink">DÃ©connexion</span>
Â  Â  </div>
Â  Â  <div class="account-info">
Â  Â  Â  <span class="balance">ADMIN</span>
Â  Â  Â  <span class="gains">Mode</span>
Â  Â  Â  <span class="mail">Gestion</span>
Â  Â  </div>
Â  Â  <div class="advisor">
Â  Â  Â  <p>SystÃ¨me<br><strong>Complet</strong></p>
Â  Â  </div>
Â  </div>
</header>

<nav class="main-nav">
Â  <ul>
Â  Â  <li><a href="manage.html">GESTION DES COMPTES</a></li>
Â  Â  <li><a href="#">OUTILS BANCAIRES</a></li>
Â  Â  <li><a href="#">RAPPORTS</a></li>
Â  </ul>
Â  <input type="search" placeholder="Rechercher" class="search-bar">
</nav>

<main>
Â  <h2 class="page-title">Tableau de Bord Administrateur</h2>

Â  <nav class="subtabs">
Â  Â  <a href="#" class="subtab active" data-subtab="dashboard-tab">Tableau de Bord Clients</a>
Â  Â  <a href="#" class="subtab" data-subtab="create-tab">CrÃ©er un Client</a>
Â  </nav>

Â  <div class="panel" data-subtab-panel="dashboard-tab">
Â  Â  <div id="user-summary-dashboard" class="account-block">
Â  Â  Â  <h3>SynthÃ¨se des Clients</h3>
Â  Â  Â  <p class="message-info">Pour l'instant, seuls les clients initialement dans data.json sont affichÃ©s. Les nouveaux clients ne s'affichent qu'aprÃ¨s un redÃ©ploiement de l'API (pour persister les donnÃ©es).</p>
Â  Â  Â  <table>
Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  <th>Nom</th>
Â  Â  Â  Â  Â  Â  <th>Code Client</th>
Â  Â  Â  Â  Â  Â  <th>Solde</th>
Â  Â  Â  Â  Â  Â  <th>Statut Compte</th>
Â  Â  Â  Â  Â  Â  <th>Action</th>
Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  </thead>
Â  Â  Â  Â  <tbody id="user-dashboard-body"></tbody>
Â  Â  Â  </table>
Â  Â  </div>
Â  </div>

Â  <div id="admin-tools" class="account-block" hidden>
Â  Â  <h3 id="managing-user-name">Gestion de : [Nom du Client]</h3>

Â  Â  <nav class="subtabs small-tabs">
Â  Â  Â  <a href="#" class="subtab active" data-subtab="manage-profile-tab">Profil & Solde</a>
Â  Â  Â  <a href="#" class="subtab" data-subtab="manage-rib-tab">RIB</a>
Â  Â  Â  <a href="#" class="subtab" data-subtab="manage-cards-tab">Cartes & Statut</a>
Â  Â  Â  <a href="#" class="subtab" data-subtab="manage-history-tab">Historique</a>
Â  Â  </nav>

Â  Â  <div class="panel" data-subtab-panel="manage-profile-tab">
Â  Â  Â  <h4>Modifier Profil & Solde</h4>
Â  Â  Â  <form id="profile-form">
Â  Â  Â  Â  <label for="manage-name">Nom Complet</label>
Â  Â  Â  Â  <input id="manage-name" required>
Â  Â  Â  Â  <label for="manage-pin">PIN (6 chiffres)</label>
Â  Â  Â  Â  <input id="manage-pin" maxlength="6" required>
Â  Â  Â  Â  <label for="manage-solde">Solde Actuel (EUR)</label>
Â  Â  Â  Â  <input id="manage-solde" type="number" step="0.01" required>
Â  Â  Â  Â  <label for="manage-phone">TÃ©lÃ©phone Mobile</label>
Â  Â  Â  Â  <input id="manage-phone" required>
Â  Â  Â  Â  <label for="manage-email">Email de Contact</label>
Â  Â  Â  Â  <input id="manage-email" type="email" required>
Â  Â  Â  Â  <label for="manage-address">Adresse Postale</label>
Â  Â  Â  Â  <input id="manage-address" required>
Â  Â  Â  Â  <label for="manage-advisor">Conseiller AttitrÃ©</label>
Â  Â  Â  Â  <input id="manage-advisor" required>
Â  Â  Â  Â  <button type="submit" class="btn btn-primary">Sauvegarder TOUTES les Modifications</button>
Â  Â  Â  </form>
Â  Â  </div>

Â  Â  <div class="panel" data-subtab-panel="manage-rib-tab" hidden>
Â  Â  Â  <h4>Modifier RIB (IBAN) & BIC</h4>
Â  Â  Â  <form id="rib-form">
Â  Â  Â  Â  <label for="manage-rib">RIB (IBAN)</label>
Â  Â  Â  Â  <input id="manage-rib" required>
Â  Â  Â  Â  <label for="manage-bic">BIC (SWIFT)</label>
Â  Â  Â  Â  <input id="manage-bic" required>
Â  Â  Â  Â  <button type="submit" class="btn btn-primary">Sauvegarder RIB</button>
Â  Â  Â  </form>
Â  Â  </div>

Â  Â  <div class="panel" data-subtab-panel="manage-cards-tab" hidden>
Â  Â  Â  <h4>GÃ©rer Cartes Bancaires & Statut Global</h4>
Â  Â  Â  <form id="card-data-form">
Â  Â  Â  Â  <label for="manage-card-number">NumÃ©ro de Carte (16 chiffres)</label>
Â  Â  Â  Â  <input id="manage-card-number" maxlength="16" required>
Â  Â  Â  Â  <label for="manage-card-holder-name">Nom du Titulaire</label>
Â  Â  Â  Â  <input id="manage-card-holder-name" required>
Â  Â  Â  Â  <label for="manage-expiry-date">Date d'Expiration (MM/AA)</label>
Â  Â  Â  Â  <input id="manage-expiry-date" placeholder="01/25" required>
Â  Â  Â  Â  <label for="manage-card-type">Type de Carte</label>
Â  Â  Â  Â  <select id="manage-card-type" required>
Â  Â  Â  Â  Â  <option value="VISA">VISA</option>
Â  Â  Â  Â  Â  <option value="MASTERCARD">MASTERCARD</option>
Â  Â  Â  Â  </select>
Â  Â  Â  Â  <button type="submit" class="btn btn-primary">Sauvegarder DonnÃ©es de Carte</button>
Â  Â  Â  </form>

Â  Â  Â  <h4 style="margin-top: 20px;">ContrÃ´le du Statut Global du Compte</h4>
Â  Â  Â  <form id="account-status-form">
Â  Â  Â  Â  <label for="manage-lock-reason">Raison du Blocage (Visible par l'administrateur)</label>
Â  Â  Â  Â  <textarea id="manage-lock-reason" rows="3" placeholder="Ex: Fraude dÃ©tectÃ©e, Documents manquants, etc."></textarea>
Â  Â  Â  Â  <div id="account-status-display" class="message-info"></div>
Â  Â  Â  Â  <button type="submit" id="toggle-account-btn" class="btn"></button>
Â  Â  Â  </form>
Â  Â  </div>

Â  Â  <div class="panel" data-subtab-panel="manage-history-tab" hidden>
Â  Â  Â  <h4>Ajouter une OpÃ©ration Manuelle (Affecte le Solde)</h4>
Â  Â  Â  <p class="message-info">Utilisez un montant nÃ©gatif pour retraits/paiements, et positif pour dÃ©pÃ´ts/virements reÃ§us.</p>
Â  Â  Â  <form id="history-form">
Â  Â  Â  Â  <label for="hist-type">Type d'OpÃ©ration</label>
Â  Â  Â  Â  <select id="hist-type" required>
Â  Â  Â  Â  Â  <option value="Virement">Virement</option>
Â  Â  Â  Â  Â  <option value="Retrait">Retrait</option>
Â  Â  Â  Â  Â  <option value="DÃ©pÃ´t">DÃ©pÃ´t</option>
Â  Â  Â  Â  Â  <option value="Paiement">Paiement Carte</option>
Â  Â  Â  Â  Â  <option value="Agio">Agio / Frais Bancaires</option>
Â  Â  Â  Â  </select>
Â  Â  Â  Â  <label for="hist-amount">Montant (EUR)</label>
Â  Â  Â  Â  <input id="hist-amount" type="number" step="0.01" required>
Â  Â  Â  Â  <label for="hist-description">Description / LibellÃ©</label>
Â  Â  Â  Â  <input id="hist-description" required>
Â  Â  Â  Â  <label for="hist-date">Date de l'OpÃ©ration</label>
Â  Â  Â  Â  <input id="hist-date" type="date" required>
Â  Â  Â  Â  <button type="submit" class="btn btn-primary">Ajouter OpÃ©ration & Mettre Ã  Jour Solde</button>
Â  Â  Â  </form>
Â  Â  </div>
Â  </div>

Â  <div class="panel" data-subtab-panel="create-tab" hidden>
Â  Â  <div class="account-block">
Â  Â  Â  <h3>CrÃ©ation d'un Nouveau Compte Client</h3>
Â  Â  Â  <form id="create-user-form">
Â  Â  Â  Â  <label for="create-name">Nom Complet</label>
Â  Â  Â  Â  <input id="create-name" required>
Â  Â  Â  Â  <label for="create-client-code">Code Client (10 chiffres)</label>
Â  Â  Â  Â  <input id="create-client-code" maxlength="10" required>
Â  Â  Â  Â  <label for="create-pin">PIN (6 chiffres)</label>
Â  Â  Â  Â  <input id="create-pin" maxlength="6" required>
Â  Â  Â  Â  <label for="create-solde">Solde Initial (EUR)</label>
Â  Â  Â  Â  <input id="create-solde" type="number" step="0.01" value="0.00" required>
Â  Â  Â  Â  <label for="create-phone">TÃ©lÃ©phone Mobile</label>
Â  Â  Â  Â  <input id="create-phone" required>
Â  Â  Â  Â  <label for="create-email">Email de Contact</label>
Â  Â  Â  Â  <input id="create-email" type="email" required>
Â  Â  Â  Â  <label for="create-address">Adresse Postale</label>
Â  Â  Â  Â  <input id="create-address" required>
Â  Â  Â  Â  <label for="create-rib">RIB (IBAN)</label>
Â  Â  Â  Â  <input id="create-rib" required>
Â  Â  Â  Â  <label for="create-bic">BIC (SWIFT)</label>
Â  Â  Â  Â  <input id="create-bic" required>
Â  Â  Â  Â  <label for="create-advisor">Conseiller AttitrÃ©</label>
Â  Â  Â  Â  <input id="create-advisor" value="M. Dupont" required>
Â  Â  Â  Â  <label for="create-cards-locked">Statut du Compte Ã  la CrÃ©ation</label>
Â  Â  Â  Â  <select id="create-cards-locked">
Â  Â  Â  Â  Â  <option value="false" selected>ACTIF</option>
Â  Â  Â  Â  Â  <option value="true">BLOQUÃ‰</option>
Â  Â  Â  Â  </select>
Â  Â  Â  Â  <button type="submit" class="btn btn-success">CrÃ©er le Nouveau Client</button>
Â  Â  Â  </form>
Â  Â  </div>
Â  </div>
</main>

<footer>
Â  <p>Â© BNP Paribas - Tous droits rÃ©servÃ©s (Mode Admin)</p>
</footer>

<script src="shared.js"></script>
<script>
// --- Script Administrateur ---

// NOTE: Les fonctions de gestion des donnÃ©es sont temporairement adaptÃ©es
// pour utiliser les donnÃ©es stockÃ©es en session (celles de l'API).
// Les fonctions update/get Users doivent Ãªtre mises Ã  jour avec l'API.

document.addEventListener('DOMContentLoaded', () => {
Â  const adminUser = checkAuth(true);
Â  if (!adminUser) return; // RedirigÃ© si pas admin

Â  const userDashboardBody = document.getElementById('user-dashboard-body');
Â  const adminTools = document.getElementById('admin-tools');
Â  const managingUserName = document.getElementById('managing-user-name');
Â  let selectedUser = null;

  // --- Fonctions Temporaires/Partielles ---
  // Ces fonctions doivent Ãªtre mises Ã  jour pour utiliser l'API (fetchUsers / apiUpdateUser)
  // Elles utilisent la session pour simuler l'affichage initial.
Â  function renderUserDashboard() {
Â  Â  // Utilise la fonction temporaire dans shared.js pour rÃ©cupÃ©rer la liste des clients
Â  Â  const allUsers = getUsersFromSession().filter(u => !u.isAdmin); 
Â  Â  userDashboardBody.innerHTML = '';
Â  Â  allUsers.forEach(user => {
Â  Â  Â  const row = userDashboardBody.insertRow();
Â  Â  Â  row.insertCell().textContent = user.name;
Â  Â  Â  row.insertCell().textContent = user.clientCode;
Â  Â  Â  row.insertCell().textContent = formatCurrency(user.solde);
Â  Â  Â  const statusCell = row.insertCell();
Â  Â  Â  statusCell.textContent = user.isLocked ? 'ðŸ”’ BLOQUÃ‰' : 'âœ… ACTIF';
Â  Â  Â  statusCell.style.color = user.isLocked ? 'red' : 'green';
Â  Â  Â  const actionCell = row.insertCell();
Â  Â  Â  const btn = document.createElement('button');
Â  Â  Â  btn.className = 'btn btn-primary btn-select-user';
Â  Â  Â  btn.textContent = 'GÃ©rer';
Â  Â  Â  // NOTE: selectUser ne fonctionne pas tant que les donnÃ©es ne sont pas rÃ©cupÃ©rÃ©es par l'API
Â  Â  Â  btn.disabled = true; 
Â  Â  Â  actionCell.appendChild(btn);
Â  Â  });
    
    // Message d'information pour la gestion
    if (allUsers.length > 0) {
         document.getElementById('user-summary-dashboard').insertAdjacentHTML('beforeend', '<p class="message-warning" style="margin-top: 10px;">La gestion (bouton "GÃ©rer") ne sera activÃ©e qu\'aprÃ¨s l\'ajout de la fonction API de rÃ©cupÃ©ration des clients.</p>');
    }
Â  }

Â  function selectUser(clientCode) {
Â  Â  // Cette fonction ne peut pas Ãªtre implÃ©mentÃ©e correctement sans l'API.
Â  Â  // On rÃ©cupÃ¨re l'utilisateur depuis la session
Â  Â  selectedUser = getUsersFromSession().find(u => u.clientCode === clientCode); 
Â  Â  if (!selectedUser) return;
Â  Â  adminTools.hidden = false;
Â  Â  managingUserName.textContent = `Gestion de : ${selectedUser.name}`;
Â  Â  loadUserData(selectedUser);
Â  Â  document.querySelector('.small-tabs [data-subtab="manage-profile-tab"]').click?.();
Â  Â  adminTools.scrollIntoView({ behavior: 'smooth' });
Â  }

Â  function loadUserData(user) {
Â  Â  // Chargement des donnÃ©es de l'utilisateur (mÃªme code que l'original)
Â  Â  document.getElementById('manage-name').value = user.name || '';
Â  Â  document.getElementById('manage-pin').value = user.pin || '';
Â  Â  document.getElementById('manage-solde').value = user.solde ?? 0;
Â  Â  document.getElementById('manage-phone').value = user.phone || '';
Â  Â  document.getElementById('manage-email').value = user.email || '';
Â  Â  document.getElementById('manage-address').value = user.address || '';
Â  Â  document.getElementById('manage-advisor').value = user.advisor || '';
Â  Â  document.getElementById('manage-rib').value = user.rib || '';
Â  Â  document.getElementById('manage-bic').value = user.bic || '';
Â  Â  document.getElementById('manage-card-number').value = user.cardNumber || '';
Â  Â  document.getElementById('manage-card-holder-name').value = user.cardHolderName || (user.name ? user.name.toUpperCase() : '');
Â  Â  document.getElementById('manage-expiry-date').value = user.expiryDate || '';
Â  Â  document.getElementById('manage-card-type').value = user.cardType || 'VISA';
Â  Â  document.getElementById('manage-lock-reason').value = user.lockReason || '';
Â  Â  updateAccountStatusDisplay(user.isLocked);
Â  }

Â  function updateAccountStatusDisplay(isLocked) {
Â  Â  // Mise Ã  jour de l'affichage du statut (mÃªme code que l'original)
Â  Â  const statusDisplay = document.getElementById('account-status-display');
Â  Â  const toggleBtn = document.getElementById('toggle-account-btn');
Â  Â  const reasonText = selectedUser && selectedUser.lockReason
Â  Â  Â  ? `<br> Motif enregistrÃ© : <strong>${selectedUser.lockReason}</strong>`
Â  Â  Â  : '';
Â  Â  if (isLocked) {
Â  Â  Â  statusDisplay.innerHTML = `Statut : Compte ACTUELLEMENT <strong>BLOQUÃ‰</strong>${reasonText}`;
Â  Â  Â  statusDisplay.className = 'message-error';
Â  Â  Â  toggleBtn.textContent = 'DÃ‰BLOQUER le Compte (et effacer le motif)';
Â  Â  Â  toggleBtn.className = 'btn btn-success';
Â  Â  } else {
Â  Â  Â  statusDisplay.innerHTML = 'Statut : Compte ACTUELLEMENT <strong>ACTIF</strong>.';
Â  Â  Â  statusDisplay.className = 'message-success';
Â  Â  Â  toggleBtn.textContent = 'BLOQUER le Compte';
Â  Â  Â  toggleBtn.className = 'btn btn-danger';
Â  Â  Â  if (selectedUser && !selectedUser.isLocked) {
Â  Â  Â  Â  document.getElementById('manage-lock-reason').value = '';
Â  Â  Â  }
Â  Â  }
Â  }

  // ------------------------------------------------------------------------------------------------------------------
  // ðŸš¨ CORRECTION CRITIQUE : CrÃ©ation de Client (maintenant asynchrone)
  // ------------------------------------------------------------------------------------------------------------------
Â  document.getElementById('create-user-form').addEventListener('submit', async (e) => {
Â  Â  e.preventDefault();
Â  Â  
    // Validation des formats
Â  Â  const clientCodeInput = document.getElementById('create-client-code').value;
Â  Â  const pinInput = document.getElementById('create-pin').value;
Â  Â  if (clientCodeInput.length !== 10 || pinInput.length !== 6 || isNaN(clientCodeInput) || isNaN(pinInput)) {
Â  Â  Â  Â  alert('Erreur: Le Code Client doit Ãªtre composÃ© de 10 chiffres et le PIN de 6 chiffres.');
Â  Â  Â  Â  return;
Â  Â  }

Â  Â  const isLockedOnCreation = document.getElementById('create-cards-locked').value === 'true';
Â  Â  const newUser = {
Â  Â  Â  name: document.getElementById('create-name').value,
Â  Â  Â  clientCode: clientCodeInput,
Â  Â  Â  pin: pinInput,
Â  Â  Â  solde: parseFloat(document.getElementById('create-solde').value),
Â  Â  Â  phone: document.getElementById('create-phone').value,
Â  Â  Â  email: document.getElementById('create-email').value,
Â  Â  Â  address: document.getElementById('create-address').value,
Â  Â  Â  rib: document.getElementById('create-rib').value,
Â  Â  Â  bic: document.getElementById('create-bic').value,
Â  Â  Â  advisor: document.getElementById('create-advisor').value,
Â  Â  Â  isAdmin: false,
Â  Â  Â  isLocked: isLockedOnCreation,
Â  Â  Â  lockReason: isLockedOnCreation ? 'Nouveau compte bloquÃ© Ã  la crÃ©ation.' : '',
Â  Â  Â  cardNumber: '0000000000000000', 
Â  Â  Â  cardHolderName: document.getElementById('create-name').value.toUpperCase(),
Â  Â  Â  expiryDate: '01/99',
Â  Â  Â  cardType: 'VISA',
Â  Â  Â  history: [] 
Â  Â  };
Â  Â  
Â  Â  // ðŸš¨ Appel asynchrone Ã  la fonction API
Â  Â  const response = await apiCreateUser(newUser);

Â  Â  if (response.success) {
Â  Â  Â  Â  alert(`Le nouveau client ${newUser.name} (Code: ${newUser.clientCode}) a Ã©tÃ© crÃ©Ã© avec succÃ¨s !`);
Â  Â  Â  Â  document.getElementById('create-user-form').reset();
Â  Â  Â  Â  // Rediriger l'affichage vers le tableau de bord
Â  Â  Â  Â  document.querySelector('.subtabs [data-subtab="dashboard-tab"]').click?.();
Â  Â  Â  Â  renderUserDashboard(); // RÃ©-afficher la liste (mÃªme si le nouveau n'apparaÃ®t pas avant un redÃ©ploiement de l'API)

Â  Â  } else {
Â  Â  Â  Â  alert(response.message || "Ã‰chec de la crÃ©ation du client. Le code client est peut-Ãªtre dÃ©jÃ  utilisÃ© sur le serveur.");
Â  Â  }
Â  });
  // ------------------------------------------------------------------------------------------------------------------


  // ------------------------------------------------------------------------------------------------------------------
  // Les autres gestionnaires de formulaire (profile-form, rib-form, etc.)
  // sont laissÃ©s tels quels, mais ils ne fonctionneront pas tant que la fonction
  // updateUser (handleUpdate) ne sera pas mise Ã  jour en apiUpdateUser.
  // ------------------------------------------------------------------------------------------------------------------
Â  document.getElementById('profile-form').addEventListener('submit', (e) => {
Â  Â  e.preventDefault();
    alert('Bouton dÃ©sactivÃ© : La fonction de mise Ã  jour API (apiUpdateUser) n\'a pas encore Ã©tÃ© implÃ©mentÃ©e.');
Â  });
Â  document.getElementById('rib-form').addEventListener('submit', (e) => {
Â  Â  e.preventDefault();
    alert('Bouton dÃ©sactivÃ© : La fonction de mise Ã  jour API (apiUpdateUser) n\'a pas encore Ã©tÃ© implÃ©mentÃ©e.');
Â  });
Â  document.getElementById('card-data-form').addEventListener('submit', (e) => {
Â  Â  e.preventDefault();
    alert('Bouton dÃ©sactivÃ© : La fonction de mise Ã  jour API (apiUpdateUser) n\'a pas encore Ã©tÃ© implÃ©mentÃ©e.');
Â  });
Â  document.getElementById('account-status-form').addEventListener('submit', (e) => {
Â  Â  e.preventDefault();
    alert('Bouton dÃ©sactivÃ© : La fonction de mise Ã  jour API (apiUpdateUser) n\'a pas encore Ã©tÃ© implÃ©mentÃ©e.');
Â  });
Â  document.getElementById('history-form').addEventListener('submit', (e) => {
Â  Â  e.preventDefault();
    alert('Bouton dÃ©sactivÃ© : La fonction d\'historique API (apiAddTransaction) n\'a pas encore Ã©tÃ© implÃ©mentÃ©e pour l\'admin.');
Â  });
  // ------------------------------------------------------------------------------------------------------------------
  

Â  // Navigation des sous-onglets (LAISSER INCHANGÃ‰)
Â  document.querySelectorAll('.subtabs .subtab').forEach(tab => {
Â  Â  tab.addEventListener('click', (e) => {
Â  Â  Â  e.preventDefault();
Â  Â  Â  const target = tab.getAttribute('data-subtab');
Â  Â  Â  document.querySelectorAll('[data-subtab-panel]').forEach(panel => {
Â  Â  Â  Â  panel.hidden = panel.getAttribute('data-subtab-panel') !== target;
Â  Â  Â  });
Â  Â  Â  document.querySelectorAll('.subtabs .subtab').forEach(t => t.classList.remove('active'));
Â  Â  Â  tab.classList.add('active');
Â  Â  });
Â  });

Â  renderUserDashboard();
});
</script>
</body>
</html>